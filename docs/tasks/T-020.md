# T-020: 优化默认年份显示（显示最近有数据的年份）

## 目标
修复查看区域详情时，如果最新年份无数据则显示空的问题，改为显示最近有数据的年份。

## 问题描述
当前代码硬编码默认年份为 2025：
```typescript
const [currentYear, setCurrentYear] = useState<number>(2025)
```

如果某区域没有 2025 年数据（如部分县级市可能数据不完整），页面会显示空白或无数据提示。

## 期望行为
- 自动检测该区域有数据的最新年份
- 默认显示该年份的数据
- 用户仍可手动切换其他年份

## 实现方案

### 修改文件：src/pages/ResultPage.tsx

```typescript
// 从历史数据中获取有数据的年份列表
const availableYears = useMemo(() => {
  const years = new Set(historyData.map(d => d.year))
  return Array.from(years).sort((a, b) => b - a) // 降序排列
}, [historyData])

// 获取最新有数据的年份
const latestAvailableYear = useMemo(() => {
  return availableYears[0] || 2025
}, [availableYears])

// 使用最新有数据的年份作为默认值
const [currentYear, setCurrentYear] = useState<number>(() => latestAvailableYear)
```

### 备选：使用 useEffect 在数据加载后设置
```typescript
const [currentYear, setCurrentYear] = useState<number>(2025)

useEffect(() => {
  if (availableYears.length > 0 && !availableYears.includes(currentYear)) {
    setCurrentYear(availableYears[0])
  }
}, [availableYears, currentYear])
```

## 验收标准
- [ ] 进入区域详情页时，默认显示该有数据的最新年份
- [ ] 如果 2025 年有数据，仍默认显示 2025
- [ ] 如果 2025 年无数据，显示最近的有数据的年份（如 2024）
- [ ] 用户可正常切换年份
- [ ] 无数据区域给出友好提示
- [ ] 构建和测试通过
- [ ] Git 提交推送
- [ ] 部署验证

## 示例场景
| 区域 | 有数据年份 | 进入页面默认显示 |
|:---|:---|:---|
| 北京 | 2015-2025 | 2025年 |
| 昆山市 | 2015-2024 | 2024年（因2025数据未收集） |
| 某新区县 | 2020-2024 | 2024年 |

## 进度
| 时间 | 事件 | 状态 |
|:---:|:---|:---:|
| 2026-02-22 | Task 创建 | ✅ |

## 提交记录
- 待添加
